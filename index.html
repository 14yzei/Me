<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>stdrice</title>
        <link rel="stylesheet" href="style.css" type="text/css">
        <style>
            body {
                max-width: 100em; 
                width: 100%; 
                height: 100%; 
                position: absolute; 
                display: table; 
            }
            p {
                display: table-cell; 
                vertical-align: middle; 
                text-align: center; 
            }
          </style>
    </head>

    <body>
        <p>
            <i>s t d r i c e</i>
            <br>
            <br>
            <img id="album-art" src="placeholder.png" width="300px" height="300px" onerror="this.src='assets/images/1.png'">
            <br>
            <span id="artist-name"></span> - <span id="song-name"><a href="#" target="_blank"></a></span>
            <br>
            <br>
            <a href="about.html">about</a> - 
            <a href="projects.html">projects</a> - 
            <a href="https://stdrice.bearblog.dev">blogs</a> - 
            <a href="webrings.html">webrings</a>
        </p>
    </body>
    
    <script>
      async function fetchLastPlayedSong() {
      const username = 'p3nguin-kun';
      const apiKey = '731cd3d44373636d778c07f281813808'; // please dont make any unauthorized usage with my api ;-;
      const url = `https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=${username}&api_key=${apiKey}&format=json`;
        
      try {
          const response = await fetch(url);
          const data = await response.json();
          const track = data.recenttracks.track[0];
        
          // Update HTML
          document.getElementById('album-art').src = track.image[3]['#text'] || 'placeholder.png';
          const songNameElement = document.getElementById('song-name').querySelector('a');
          songNameElement.textContent = track.name || 'Unknown Song';
          songNameElement.href = track.url || '#';
        
          document.getElementById('artist-name').textContent = track.artist['#text'] || 'Unknown Artist';
          document.getElementById('album-name').textContent = track.album['#text'] || 'Unknown Album';
          } catch (error) {
              console.error('Error fetching song data:', error);
            }
        }
        
        // Fetch song data on load
        fetchLastPlayedSong();
        
        // Optionally refresh every 60 seconds
        setInterval(fetchLastPlayedSong, 60000);
    </script>
</html>
